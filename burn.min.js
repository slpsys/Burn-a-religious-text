function buildScene(){var a=document.getElementById("burn"),b=document.getElementById("fire"),c=buildLibrary(a,["bible","quran","torah","mormon","vedas","dianetics"],40);c.registerBgObject(new BackgroundObject(0,0,b));c.discrim=b.height;loop(function(){c.drawAll.apply(c)},25);c.drawAll();a.onmousedown=function(e){c.moveStarted(e)};a.onmouseup=function(e){c.moveStopped(e)}}
function buildLibrary(a,b,c){var e=new BookCollection(a),d,f=0;for(var g in b){imageSet=new ImageSet(b[g]);if(d&&0<f%3)d=new Book(c+d.getBoundingRect()[2],d.y+(d.image.height-imageSet.normal.height),imageSet.normal,imageSet.burning,imageSet.name);else{y=a.height-imageSet.normal.height-f/3*(d?d.image.height+c:0);d=new Book(c,y,imageSet.normal,imageSet.burning,imageSet.name)}e.add(d);d=d;f++}return e}function loop(a,b){if(a&&b>0){a();setInterval(a,b)}}
var RelativeCoords=function(a,b){this.x=b.clientX-a.offsetLeft;this.y=b.clientY-a.offsetTop;return this},ImageSet=function(a){this.normal=document.getElementById(a);this.normal.src="img/"+a+"_static.gif";this.burning=document.getElementById(a+"_burning");this.name=a;return this},BackgroundObject=function(a,b,c){this.x=a;this.y=b;this.image=c},Book=function(a,b,c,e,d){this.x=a;this.y=b;this.image=c;this.burning=e;this.name=d};
Book.prototype.getBoundingRect=function(){return[this.x,this.y,this.x+this.image.width,this.y+this.image.height]};Book.prototype.draw=function(a){a.getContext&&a.getContext("2d").drawImage(this.image,this.x,this.y)};Book.prototype.isInRect=function(a,b){var c=new RelativeCoords(a,b),e=this.getBoundingRect(),d=false;if(c.x>=e[0]&&c.x<=e[2]&c.y>=e[1]&&c.y<=e[3])d=true;return d};Book.prototype.getRelative=function(a,b){return[a-this.x,b-this.y]};Book.prototype.move=function(a,b){this.x=a;this.y=b};
Book.prototype.checkForBurn=function(a){var b=false;if(this.getBoundingRect()[3]<a){this.image.src=this.image.src.replace("_static","_burn");b=true}return b};var BookCollection=function(a){this.canvas=a;this.bgObjects=[];this.discrim=0};BookCollection.prototype=[];BookCollection.prototype.add=function(a){this.push(a)};BookCollection.prototype.getBookByClick=function(a){var b;for(var c in this)if(this[c].isInRect&&this[c].isInRect(this.canvas,a))b=this[c];return b};
BookCollection.prototype.registerBgObject=function(a){a&&this.bgObjects.push(a)};BookCollection.prototype.moveStarted=function(a){var b=this,c=this.getBookByClick(a);if(c){a=new RelativeCoords(this.canvas,a);this.bookMoving=c;this.bookOffset=this.bookMoving.getRelative(a.x,a.y);this.canvas.onmousemove=function(){b.moving.apply(b,arguments)}}};
BookCollection.prototype.moveStopped=function(){this.canvas.onmousemove=null;this.drawAll();if(this.bookMoving&&this.bookMoving.checkForBurn(this.discrim)){var a=this;setTimeout(function(){a.removeByName.apply(a,[a.bookMoving.name])},4E3)}};BookCollection.prototype.moving=function(a){document.getElementById("console");coords=new RelativeCoords(this.canvas,a);this.bookMoving.move(coords.x-this.bookOffset[0],coords.y-this.bookOffset[1]);this.drawAll()};
BookCollection.prototype.drawAll=function(){if(this.canvas.getContext){var a=this.canvas.getContext("2d");a.clearRect(0,0,this.canvas.width,this.canvas.height);for(var b in this.bgObjects)a.drawImage(this.bgObjects[b].image,this.bgObjects[b].x,this.bgObjects[b].y);for(b in this)this[b].draw&&this[b].draw(this.canvas)}};BookCollection.prototype.removeByName=function(a){var b;for(var c in this)if(this[c]&&this[c].name===a){b=c;break}b&&this.splice(b,1)};window.onload=function(){buildScene()};